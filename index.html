<!doctype html>
<html class='no-js' lang=''>
    <head>
        <meta charset='utf-8'>
        <meta http-equiv='X-UA-Compatible' content='IE=edge'>
        <title>Brief</title>
        <meta name='description' content='a brief look at new and trending stories'>
        <meta name='viewport' content='width=device-width, initial-scale=1'>
        <link rel='apple-touch-icon' href='img/apple-icon-brief.jpg'>
        <link rel='shortcut icon' type='image/gif' href='https://apps.bostonglobe.com/common/img/favicon.ico' />

        <style>
            .logo a,article,aside,details,figcaption,figure,footer,header,hgroup,menu,nav,section{display:block}.story a,.story a:hover{text-decoration:none}a,abbr,acronym,address,applet,article,aside,audio,b,big,blockquote,body,canvas,caption,center,cite,code,dd,del,details,dfn,div,dl,dt,em,embed,fieldset,figcaption,figure,footer,form,h1,h2,h3,h4,h5,h6,header,hgroup,html,i,iframe,img,ins,kbd,label,legend,li,mark,menu,nav,object,ol,output,p,pre,q,ruby,s,samp,section,small,span,strike,strong,sub,summary,sup,table,tbody,td,tfoot,th,thead,time,tr,tt,u,ul,var,video{margin:0;padding:0;border:0;font:inherit;vertical-align:baseline}.btn,body{font-family:Helvetica,Arial,sans-serif;font-weight:300}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:after,blockquote:before,q:after,q:before{content:'';content:none}table{border-collapse:collapse;border-spacing:0}*{margin:0;padding:0;box-sizing:border-box;-moz-box-sizing:border-box}body{font-size:16px;line-height:1.6}p{color:#666}a,a:visited{color:#262626}.btn{border:none;background:0 0;font-size:1em;color:#888;background-color:rgba(89,136,157,.2);padding:.2em .6em;cursor:pointer}.btn.selected{background-color:rgba(89,136,157,.8);color:#efefef}.logo a svg{height:20px;width:150px}.section-and-date,.stories{height:100%;overflow:hidden}.header{padding-bottom:.25em;max-width:480px;margin:0 auto;text-align:center}.explanation{font-size:.9em;color:#888;margin-top:.25em}.section,.updated{font-weight:700;color:#59889d}.updated{font-size:.8em;margin-top:1em}.container{padding:1em 0}.stories{margin:1.5em auto;width:100%;max-width:480px}.date,.section{float:left;width:50%}.story{margin-bottom:2em;padding-bottom:.75em}.section-and-date{margin-bottom:.25em;font-size:.8em;padding-top:.5em;border-top:1px solid #efefef}.section{text-align:left;text-transform:capitalize}.date{text-align:right;color:#888}.image{width:100%;height:200px;background:50% 25% no-repeat #eee;background-size:cover;position:relative}.hide{display:none}.story a{display:block}.hed{text-align:left;margin:.5em 0 .25em;color:#333;font-family:Miller,Georgia,serif;line-height:1.4;font-size:1.3em;letter-spacing:normal}.description{font-family:Georgia,serif;margin:0}a.lite{display:block;position:absolute;top:8px;right:0;width:35px;height:35px}.lite svg{width:100%;height:100%}.lite svg path{fill:rgba(255,255,255,.6);stroke:rgba(50,50,50,.4);stroke-width:1px}@media only screen and (max-width:500px){.story a{padding-left:.75em;padding-right:.75em}.section-and-date{padding-left:1em;padding-right:1em}}
        </style>
        <script>
            /*! FilamentGroup.com - v0.1.0 - 2014-07-24
* http://filamentgroup.com/
* Copyright (c) 2014 Filament Group *//*! EnhanceJS: a progressive enhancement boilerplate. Copyright 2014 @scottjehl, Filament Group, Inc. Licensed MIT */
(function( window, undefined ) {
  var filepath = 'https://apps.bostonglobe.com/common/font/';
  // Enable JS strict mode
  "use strict";
  // Define some variables to be used throughout this file
  var doc = window.document;
  // loadCSS: load a CSS file asynchronously. Included from https://github.com/filamentgroup/loadCSS/
  function loadCSS( href, before, media ){
    // Arguments explained:
    // `href` is the URL for your CSS file.
    // `before` optionally defines the element we'll use as a reference for injecting our <link>
    // By default, `before` uses the first <script> element in the page.
    // However, since the order in which stylesheets are referenced matters, you might need a more specific location in your document.
    // If so, pass a different reference element to the `before` argument and it'll insert before that instead
    // note: `insertBefore` is used instead of `appendChild`, for safety re: http://www.paulirish.com/2011/surefire-dom-element-insertion/
    var ss = window.document.createElement( "link" );
    var ref = before || window.document.getElementsByTagName( "script" )[ 0 ];
    var sheets = window.document.styleSheets;
    ss.rel = "stylesheet";
    ss.href = href;
    // temporarily, set media to something non-matching to ensure it'll fetch without blocking render
    ss.media = "only x";
    // inject link
    ref.parentNode.insertBefore( ss, ref );
    // This function sets the link's media back to `all` so that the stylesheet applies once it loads
    // It is designed to poll until document.styleSheets includes the new sheet.
    function toggleMedia(){
      var defined;
      for( var i = 0; i < sheets.length; i++ ){
        if( sheets[ i ].href && sheets[ i ].href.indexOf( href ) > -1 ){
          defined = true;
        }
      }
      if( defined ){
        ss.media = media || "all";
      }
      else {
        setTimeout( toggleMedia );
      }
    }
    toggleMedia();
    return ss;
  }
  /* Enhancements for qualified browsers - “Cutting the Mustard”
    Add your qualifications for major browser experience divisions here.
    For example, you might choose to only enhance browsers that support document.querySelector (IE8+, etc).
    Use case will vary.
    */
  if( !( "querySelector" in doc ) ){
    // basic browsers: last stop here!
    return;
  }
  /* Load custom fonts
    We prefer to load fonts asynchronously so that they do not block page rendering.
    To do this, a meta tag with a name matching the fontsWoffKey should have a content attribute referencing the path to this fonts file.
    NOTE: You may want to have logic here to choose between one of many font formats before loading it.
      For example, we often load WOFF, WOFF2, or Truetype. If so, just define meta tags for each
    */
  var supportsWoff2 = (function( win ){
    if( !( "FontFace" in win ) ) {
      return false;
    }
    // an empty woff2 with no glyphs
    var f = new win.FontFace( "t", 'url( "data:application/font-woff2," ) format( "woff2" )' );
    f.load().catch(function(){});
    return f.status === 'loading';
  })( window );

  // load font (woff)
  var ua = navigator.userAgent,
    fontFileUrl = filepath + "woff.css";
  if( supportsWoff2 ) {
    fontFileUrl = filepath + "woff2.css";
  // sometimes you have to do the bad thing.  ¯\_(ツ)_/¯
  //  ttf if non-chrome android webkit browser
  } else if( ua.indexOf( "Android" ) > -1 && ua.indexOf( "like Gecko" ) > -1 && ua.indexOf( "Chrome" ) === -1 ){
    fontFileUrl = filepath + 'ttf.css';
  }
  loadCSS( fontFileUrl );
}( this ));
        </script>
    </head>
    <body>
        <div class='container'>
            <div class='header'>
                <div class='logo'><a href='http://bostonglobe.com'>
                    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0" y="0" width="104.97" height="14" viewBox="0 0 104.97 14" enable-background="new 0 0 104.965 14" xml:space="preserve"><path d="M96.97 8.61c0 1.03-0.05 3.05-0.05 3.12l-0.07 0.07 -1.95-1.22V5.79c0.31-0.47 0.73-0.7 1.1-0.7 0.45 0 0.77 0.33 0.94 0.77C96.94 6.05 96.97 7.29 96.97 8.61M103.39 6.66l-1.81 1.48V4.79L103.39 6.66zM98.61 10.91c-0.12-1.06-0.09-3.92-0.09-5.25 0-0.87-0.75-1.5-1.69-1.9l-1.92 1.62V1.85c0-0.58 0.35-1.22 0.77-1.22V0.52c-0.91 0-1.92 0.73-2.09 1.2 -0.21-0.35-0.7-0.56-1.17-0.56l-0.02 0.19c0.47 0 0.91 0.8 0.91 2.21 0 2.84-0.02 5.56-0.02 6.73 0 0.38-0.05 0.63-0.26 0.94l2.89 1.76C97.01 11.94 97.44 11.63 98.61 10.91M104.97 10.46l-0.14-0.14c-0.73 0.73-1.15 1.03-1.57 1.03 -0.42 0-0.82-0.26-1.66-0.91V8.51l3.31-2.65c-0.77-0.66-2.37-2.25-2.37-2.25 -0.89 0.8-1.41 1.24-2.65 2.11 0.05 0.26 0.1 0.61 0.1 0.89v3.73c0 0.26-0.02 0.45-0.12 0.75l2.6 1.83L104.97 10.46zM74.13 8.98c0 0.63-0.19 1.03-0.61 1.36 -0.96-0.94-1.43-2.25-1.43-3.56 0-1.97 0.68-2.72 1.62-3.4 0.14-0.12 0.28-0.21 0.42-0.3V8.98zM76.66 11.68c-1.24-0.09-2.2-0.52-2.95-1.15 1.15-0.8 1.88-1.19 1.88-2.42V2.04l0.35-0.28c0.26 0.09 0.47 0.19 0.73 0.28L76.66 11.68 76.66 11.68zM80.32 8.91c0 0.68-0.07 1.15-0.26 1.71 -0.68 0.68-1.69 1.08-2.84 1.08h-0.33V5.68c0.21-0.02 0.4-0.05 0.59-0.05C79.17 5.63 80.32 7.15 80.32 8.91M79.4 3.35l-2.51 2.23V2.13C77.79 2.49 78.58 2.91 79.4 3.35M90.24 11.56l-0.14 0.09 -1.99-1.27V4.79l2.11 1.03L90.24 11.56zM81.89 1.34l-0.21-0.19L80.9 1.97c0 0-1.99-0.66-3.61-1.59 -2.23 1.69-3.92 2.88-6.1 4.43 -0.52 0.77-0.8 1.78-0.8 2.88 0 3 2.77 5.35 6.26 5.35 2.27-0.96 3.9-2.3 5.09-3.91 0.07-0.33 0.09-0.8 0.09-1.06 0-2.18-1.48-3.4-3.05-3.77L81.89 1.34zM91.97 4.97l-2.81-1.45c-0.87 0.8-1.71 1.38-2.84 1.95 0.07 0.21 0.14 1.08 0.14 1.62v3.87c-0.26 0.28-0.52 0.42-0.77 0.42 -0.26 0-0.54-0.12-0.89-0.37V1.62c0-0.54 0.33-1.17 0.75-1.17v-0.07c-0.87 0-1.64 0.4-1.87 1.05 -0.21-0.35-0.54-0.66-1.03-0.66l-0.02 0.09c0.28 0 0.56 0.8 0.56 1.55v7.53c0 0.73-0.09 1.1-0.37 1.5l1.88 1.36 1.76-1.52 2.72 1.64c1.03-0.96 1.64-1.52 2.79-2.2 -0.07-0.35-0.09-1.03-0.09-1.31V6.08C91.86 5.51 91.88 5.21 91.97 4.97M47.44 11.75c-0.68-0.61-1.62-1.12-3.12-1.12l2.3-2.44 0.8 0.7L47.44 11.75zM48.21 6.1L46.25 8.23l-0.87-0.63V4.76C46.27 5.37 46.78 5.7 48.21 6.1M57.9 11.8l-0.09 0.07 -1.88-1.15V4.86l1.97 1.17V11.8zM59.73 10.93c-0.09-0.3-0.12-0.61-0.12-0.89V5.11l-2.56-1.43c-0.82 0.82-1.76 1.41-2.95 2.06 0.07 0.23 0.12 0.61 0.12 0.87v4.15c-0.38 0.4-0.75 0.63-1.08 0.63 -0.33 0-0.66-0.14-1.01-0.52 0-0.33 0.02-3.89 0.02-6.07h1.83V4.36l-1.83-0.07c0 0 0.02-1.71 0.05-2.06h-0.21l-2.56 2.7c-1.1-0.16-1.92-0.56-3.12-1.38 -0.94 0.96-1.57 1.41-2.7 1.95 0.05 0.56 0.07 0.87 0.07 1.43 0 0.66 0 0.87-0.05 1.43l1.5 1.05 -1.41 1.48c-0.61 0.63-0.84 1.15-0.84 1.66 0 0.47 0.19 0.85 0.47 1.2l0.17-0.09c-0.19-0.28-0.3-0.61-0.3-0.91 0-0.49 0.26-0.91 0.99-0.91 0.73 0 1.53 0.47 2.32 1.1 0.89-0.82 1.55-1.36 2.53-1.85V8.68c0-0.28 0.02-0.4 0.1-0.59l-1.5-1.01 1.92-2.09h0.89c0 2.13-0.02 4.88-0.02 5.18 0 0.38-0.07 0.85-0.33 1.22l2.13 1.57 1.83-1.66 2.65 1.73C57.76 12.08 58.58 11.44 59.73 10.93M68.24 11.26l-0.16-0.19 -0.8 0.68c-0.4 0-0.68-0.28-0.68-0.73 0-0.4 0.02-5.04 0.05-5.84 -0.31-0.61-0.7-1.08-1.6-1.38L62.92 5.37c0-0.66-0.37-1.24-1.1-1.62l-1.24 1.06 0.66 0.7c0 0-0.02 4.13-0.02 4.81 0 0.68-0.49 1.17-0.49 1.17l1.95 1.43 1.03-1.27 -0.77-0.7V5.79c0.38-0.49 0.77-0.7 1.13-0.7 0.4 0 0.73 0.28 0.82 0.68 0.02 0.31 0.02 0.8 0.02 1.31 0 0.8 0 3.61-0.02 4.71 0.14 0.49 0.87 1.17 1.34 1.17L68.24 11.26zM33.91 7.76l-0.05 3.38c-0.35 0.19-0.58 0.31-0.91 0.54 -0.26-0.16-0.51-0.33-0.82-0.52V6.8L33.91 7.76zM34.17 4.83c0 0.52-0.47 0.77-2.04 1.76V5.09c0-0.75 0.05-1.17 0.07-1.48H31.87c0.05 0.33 0.07 0.73 0.07 1.48v5.98c-0.98-0.59-2.18-1.2-3.45-1.29 1.2-0.68 2.39-1.59 2.39-2.93v-2.93c0-0.94 0.38-1.5 1.36-2.35 0.77 1.15 1.08 1.64 1.69 2.67C34.07 4.48 34.17 4.71 34.17 4.83M40.8 11.75L40.71 11.82l-1.85-1.13V4.76l1.95 1.1L40.8 11.75 40.8 11.75zM31.1 1.17l-0.05-0.14c-0.98 0-1.52-0.12-2.04-0.21 -0.49-0.07-0.91-0.16-1.5-0.16 -1.55 0-2.56 0.8-2.56 2.09 0 0.54 0.12 0.84 0.47 1.24l0.14-0.14c-0.19-0.23-0.28-0.47-0.28-0.73 0-0.56 0.47-1.05 1.5-1.05 0.77 0 1.48 0.14 2.09 0.28 -1.31 0.96-2.11 1.67-2.11 3.71 -0.19-0.07-0.45-0.12-0.8-0.12 -0.98 0-1.5 0.66-1.5 1.29 0 0.28 0.07 0.59 0.26 0.8l0.16-0.09c-0.07-0.14-0.12-0.28-0.12-0.42 0-0.42 0.33-0.75 0.94-0.75 0.54 0 0.94 0.24 1.13 0.56 0 1.43-0.28 2.16-1.03 2.16v0.16c1.13 0 2.49-0.82 2.49-2.13V4.88C28.28 2.72 29.55 1.71 31.1 1.17M36 7.11L33.91 5.72c0.8-0.49 1.06-0.63 1.34-0.84 0.49-0.35 0.63-0.56 0.63-0.77 0-0.16-0.07-0.47-0.44-1.03 -0.47-0.7-0.91-1.38-1.85-2.7 -1.31 0.89-2.04 1.43-3.42 2.51 -0.56 0.45-0.98 1.15-0.98 2.04 0 0.31 0.02 1.88 0.02 2.91 0 0.8-0.14 1.22-0.98 1.92 -2.04 0-3.26 1.31-3.26 2.63 0 0.56 0.19 1.15 0.61 1.62l0.14-0.14c-0.26-0.28-0.47-0.73-0.47-1.24 0-0.7 0.52-1.48 2.13-1.48 1.78 0 3.45 1.22 4.41 1.81 1.38-1.17 2.25-1.66 4.03-2.25V7.72C35.81 7.51 35.88 7.29 36 7.11M42.7 5.07l-2.7-1.48c-0.82 0.82-1.88 1.48-3.07 2.13 0.16 0.49 0.12 1.13 0.12 1.92 0 1.95 0.02 3-0.33 3.52l2.98 1.83c0.82-0.85 1.71-1.5 2.91-2.16 -0.09-0.3-0.12-0.61-0.12-0.89V6.61C42.49 5.63 42.59 5.28 42.7 5.07M3.35 8.73c0 0.7-0.12 1.13-0.49 1.45C1.99 9.29 1.52 8.02 1.52 6.59c0-0.8 0.14-1.41 0.42-1.83 0.47-0.42 1.03-0.82 1.41-1.03v1.81V8.73zM6.03 11.68c-1.17-0.14-2.18-0.59-2.93-1.27 1.45-1.06 1.78-1.66 1.78-2.84V2.81l0.05-0.05c0.47 0.05 0.73 0.07 1.1 0.09V11.68zM20.1 6.68l-1.9 1.52V4.93l0.07-0.07L20.1 6.68zM21.58 10.46l-0.14-0.14c-0.75 0.8-1.08 1.01-1.64 1.01 -0.42 0-0.91-0.26-1.59-0.89V8.51l3.38-2.58 -2.3-2.27c-1.01 0.8-1.17 0.94-1.9 1.5 -0.4 0.3-0.63 0.45-0.89 0.56 0.05 0.28 0.09 0.68 0.09 0.96v4.29c-0.4 0.38-0.77 0.54-1.05 0.54 -0.38 0-0.66-0.23-0.66-0.63V5.14c-0.23-0.73-0.68-1.2-1.55-1.5L11.19 5.37V1.34c0-0.58 0.33-1.12 0.63-1.27V0c-0.87 0-1.48 0.56-1.73 1.22L9.71 0.45 9.57 0.47v10.32c-0.84 0.44-1.76 0.94-2.77 0.94 -0.19 0-0.35 0-0.54-0.02V2.89c0.45 0.05 0.73 0.07 0.99 0.07 0.4 0 0.66-0.07 0.84-0.16l1.15-2.35L9.05 0.4C8.61 1.29 8.37 1.43 7.41 1.43c-0.44 0-1.43-0.12-2.42-0.23 -0.94-0.12-1.9-0.23-2.39-0.23 -1.45 0-2.3 1.01-2.3 2.04 0 0.42 0.14 0.84 0.42 1.22l0.16-0.12C0.7 3.87 0.59 3.56 0.59 3.31c0-0.42 0.33-0.8 1.22-0.8 0.35 0 1.6 0.12 2.77 0.21 -1.34 0.66-2.44 1.36-3.73 2.35C0.28 5.82 0 6.78 0 7.76c0 2.53 1.92 5.27 6.17 5.27C7.41 12.34 9.24 11.28 9.24 11.28l1.69 1.52 1.17-1.15 -0.91-0.96v-4.9c0.4-0.54 0.84-0.77 1.2-0.77 0.4 0 0.77 0.28 0.87 0.8v5.89c0.14 0.49 0.73 0.96 1.31 1.13l2.09-1.57 2.42 1.66L21.58 10.46z"/></svg>
                </a></div>
                <div class='explanation'>
                    A brief look at <button class='btn selected' data-choice='recent'>new</button> &amp; <button class='btn' data-choice='chartbeat'>trending</button> stories
                </div>
                <div class='updated'></div>
            </div>
            <div class='stories'>
                <div class='stories-group stories--recent hide'></div>
                <div class='stories-group stories--chartbeat hide'></div>
            </div>
        </div>
        <script>
            (function() {
    var _data;
    var _choice = 'recent';
    var _biggerImage = false;
    var _buttonElements = document.getElementsByClassName('btn');

    var init = function() {
        loadData();
        setupSize();
        setupEvents();
    };

    var setupSize = function() {
        var threshold = 640;
        var width = window.innerWidth * window.devicePixelRatio;
        _biggerImage = width > threshold;
    };

    var setupEvents = function() {
        for(var i = 0; i < _buttonElements.length; i++) {
            var el = _buttonElements[i];
            el.addEventListener('click', function(e) {
                _choice = this.getAttribute('data-choice');
                displayStories(_data[_choice]);
                this.classList.add('selected');
                if (this.nextElementSibling) {
                    this.nextElementSibling.classList.remove('selected');
                } else {
                    this.previousElementSibling.classList.remove('selected');
                }
            }, false);
        }
    };

    var loadData = function() {
        var url = 'https://www.boston.com/partners/brief.jsonp?';
        var scriptData = document.createElement('script');
        var date = new Date();
        var v = '_=' + date.getTime();
        scriptData.src = url + v + '?callback=?';
        document.getElementsByTagName('body')[0].appendChild(scriptData);
    };

    var displayStories = function(data) {
        var num = data.length;
        var storiesEl = document.getElementsByClassName('stories--' + _choice)[0];

        if (storiesEl.querySelectorAll('.story').length < 1) {
            for(var i = 0; i < num; i++ ) {
                var datum = data[i];

                if(shouldDisplay(datum)) {
                    var html = createHTML(datum, i);
                    storiesEl.appendChild(html);
                }
            }
        }

        // show this choice, hide other
        var storiesGroup = document.getElementsByClassName('stories-group');
        storiesGroup[0].classList.add('hide');
        storiesGroup[1].classList.add('hide');

        storiesEl.classList.remove('hide');
        document.body.scrollTop =document.documentElement.scrollTop = 0;
    };

    var shouldDisplay = function(datum) {
        if(!datum.description) {
            return false;
        }

        var s = datum.section;
        if (s === 'North' || s === 'South' || s === 'West' || s === 'Real estate') {
            return false;
        }

        if(datum.hed.indexOf('The Big Picture') > -1) {
            return false;
        }

        return true;
    };

    var createHTML = function(datum, i) {
        var description = shortenDescription(datum.description);
        var time = datum.diff ? datum.diff : datum.date;
        
        var html = '';
        html += '<div class="section-and-date"><p class="section">' + datum.section + '</p><p class="date">' + time + '</p></div>';
        html += '<div class="image">';
        html += '</div>';
        html += '<a title="' + datum.hed + '" href="' + datum.url + '">';
        html += '<h1 class="hed">' + datum.hed + '</h1>';
        html += '<p class="description">' + description + '</p></div>';
        html += '</a>';

        var el = document.createElement('div');

        el.innerHTML = html;
        el.classList.add('story');

        setBgImage(el, datum);
        
        return el;
    };

    var setBgImage = function(el, datum) {
        var imgEl = el.querySelectorAll('.image')[0];

        if(replaceWithLogo(datum.image)) {
            datum.image = 'img/bg.jpg';
            imgEl.classList.add('hide');
        } else {
            img = new Image();
            replace = false;

            if(_biggerImage) {
                datum.image = datum.image.replace('585w', '835w');    
            }

            //https!
            datum.image = datum.image.replace('http:', 'https:');

            var bg = 'url(\''+ datum.image +'\')';
            imgEl.style.backgroundImage = bg;
        }
    };

    var replaceWithLogo = function(img) {
        if(!img) {
            return true;
        }
        if(img.indexOf('logo-bg-small-square') > -1) {
            return true;
        }
        //staff drawing
        if(img.indexOf('Staff/Caricatures') > -1) {
            return true;   
        }
        //scribblelive
        if(img.indexOf('avatars.scribblelive') > -1) {
            return true;
        }
        return false;
    };

    var showTime = function(updated) {
        var el = document.getElementsByClassName('updated')[0];
        el.innerText = 'Updated at ' + updated.time;
    };

    var shortenDescription = function(str) {
        var max = 240;
        if(str && str.length > max) {
            var sub = str.substring(0, max);
            var lastSpace = sub.lastIndexOf(' ');
            return sub.substring(0, lastSpace) + '...';
        } else {
            return str;
        }
    };

    var cleanRecent = function(data) {
        data.sort(function(a, b){
          return new Date(b.updated) - new Date(a.updated);
        });

        // est
        var now = convertToTimezone(-4.0);

        for (var i = 0; i < data.length; i++ ) {
            var datum = data[i];
            datum.diff = Math.round((now - new Date(datum.updated)) / 60000) + 'm ago';
            datum.image = getImageSource(datum.lead);
            datum.description = datum.description || '';
        }

        return data;
    };

    var getImageSource = function(html) {
        if(html) {
            var div = document.createElement('div');
            div.innerHTML = html;
            var img = div.querySelectorAll('img')[0];
            var src = 'http:' + img.getAttribute('data-fullsrc');
            return src;
        } else {
            return false;
        }
    };

    var convertToTimezone = function(offset) {

        clientDate = new Date();
        utc = clientDate.getTime() + (clientDate.getTimezoneOffset() * 60000);

        newDate = new Date(utc + (3600000 * offset));

        return newDate;
    };

    window.brief = function(result) {
        _data = result;
        if(_data) {

            if(_data.recent) {
                _data.recent = cleanRecent(_data.recent);
            }

            if(_data[_choice]) {
                var data = _data[_choice];
                displayStories(data);
            }

            if(_data.updated) {
                showTime(_data.updated);   
            }

        } else {
            console.log('error loading data');
        }
    };

    init();
})();
        </script>
        <script>
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

            ga('create', 'UA-62479967-1', 'auto');
            ga('send', 'pageview');
        </script>
    </body>
</html>